var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},beginLayer=function(t){function e(){var e=t.call(this)||this;return e.draw(),e}return __extends(e,t),e.prototype.draw=function(){this.graphics.beginFill(16777215),this.graphics.drawRect(0,0,data.getStageWidth(),data.getStageHeight()),this.graphics.endFill()},e}(egret.Sprite);__reflect(beginLayer.prototype,"beginLayer");var Main=function(t){function e(){var e=t.call(this)||this;new Game(e);return e}return __extends(e,t),e.prototype.draw=function(){var t=new Box;t.x=100,t.y=200,this.addChild(t);var e=new Pipline;e.x=300,e.caHeight=300,this.addChild(e);var i=new earth;i.y=6*data.getStageHeight()/7,this.addChild(i)},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var Box=function(t){function e(){var e=t.call(this)||this;return e._fps=0,e.draw(),e._timer=new egret.Timer(50,0),e._timer.addEventListener(egret.TimerEvent.TIMER,e.timeFunc,e),e._timer.addEventListener("timerStart",e.timerStart,e),e._timer.addEventListener("timerStop",e.timerStop,e),e.timerStart(),e}return __extends(e,t),e.prototype.draw=function(){this.graphics.lineStyle(2,16773120),this.graphics.beginFill(0),this.graphics.drawCircle(0,0,data.getBoxRad()),this.graphics.endFill()},e.prototype.timeFunc=function(){this.y+10<data.getSpHeight()-10&&(this.y+=this._fps,this._fps+=1.1)},Object.defineProperty(e.prototype,"fps",{set:function(t){this._fps=t},enumerable:!0,configurable:!0}),e.prototype.timerStart=function(){this._timer.start()},e.prototype.timerStop=function(){this._timer.stop()},e}(egret.Sprite);__reflect(Box.prototype,"Box");var data=function(){function t(){}return t.getStageWidth=function(){return 0==t.stageWidth&&(t.stageWidth=egret.MainContext.instance.stage.stageWidth),t.stageWidth},t.getStageHeight=function(){return 0==t.stageHeight&&(t.stageHeight=egret.MainContext.instance.stage.stageHeight),t.stageHeight},t.getSpHeight=function(){return 6*t.getStageHeight()/7},t.getscore=function(){return t.score},t.updatescor=function(){t.score+=1},t.getBoxRad=function(){return t.boxRad},t.getPiplineX=function(){return t.getStageWidth()/4},t}();data.stageWidth=0,data.stageHeight=0,data.score=0,data.boxRad=20,__reflect(data.prototype,"data");var earth=function(t){function e(){var e=t.call(this)||this;return e.draw(),e}return __extends(e,t),e.prototype.draw=function(){this.graphics.beginFill(0),this.graphics.drawRect(0,0,data.getStageWidth(),10),this.graphics.endFill()},e}(egret.Sprite);__reflect(earth.prototype,"earth");var Game=function(){function t(t){this.number=0,this._moveLayer=[],this._index=0,this._root=t,this.draw(),this._moveTimer=new egret.Timer(50,0),this._moveTimer.addEventListener(egret.TimerEvent.TIMER,this.MoveLayerTimerFunc,this),this._contentTimer=new egret.Timer(50,0),this._contentTimer.addEventListener(egret.TimerEvent.TIMER,this.constractTimerFunc,this),this._root.addEventListener("GameOver",this.gameOver,this),this._score=new ScoreLabel,this._score.showText(),this._scoreTimer=new egret.Timer(50,0),this._scoreTimer.addEventListener(egret.TimerEvent.TIMER,this.socreFunc,this),this.startgame()}return t.prototype.draw=function(){this.CreateWorld(),this.CreateWorld(),this._moveLayer[1].x=data.getStageWidth(),this._box=new Box,this._box.x=1,this._box.y=1,this._root.addChild(this._box)},t.prototype.CreateWorld=function(){var t=new moverLayer;this._root.addChild(t),this._moveLayer.push(t)},t.prototype.onClick=function(t){this._box.fps=0,this._flag=!1,this._root.dispatchEventWith("timerStop");var e=egret.Tween.get(this._box);e.to({y:this._box.y-70},100).call(this.startBoxTimer).wait(10)},t.prototype.startBoxTimer=function(){this._flag=!0},t.prototype.MoveLayerTimerFunc=function(){this._moveLayer[0].x-=5,this._moveLayer[1].x-=5,this._moveLayer[this._index].x<=-data.getStageWidth()&&(this._moveLayer[this._index].x=this._moveLayer[1-this._index].x+data.getStageWidth(),this._moveLayer[this._index].clearChildren(),this._moveLayer[this._index].CreatePiplineList(),this._index=1-this._index)},t.prototype.constractTimerFunc=function(){if(4==this._moveLayer[this._index].PipArray.length){for(var t=0;4>t;t++){var e=this._moveLayer[this._index].PipArray[t].hitTestPoint(this._box.x+10,this._box.y),i=this._moveLayer[this._index].PipArray[t].hitTestPoint(this._box.x,this._box.y+10),r=this._moveLayer[this._index].PipArray[t].hitTestPoint(this._box.x,this._box.y-10);(1==e||1==i||1==r)&&(console.log("Contract Layer True"),this._root.dispatchEventWith("GameOver"))}(this._box.x<=data.getStageWidth()/4+this._moveLayer[this._index].x+data.getStageWidth()/5+2.5&&this._box.x>=data.getStageWidth()/4+this._moveLayer[this._index].x+data.getStageWidth()/5-2.5||this._box.x<=3*data.getStageWidth()/4+this._moveLayer[this._index].x+data.getStageWidth()/5+2.5&&this._box.x>=3*data.getStageWidth()/4+this._moveLayer[this._index].x+data.getStageWidth()/5-2.5)&&data.updatescor(),this._moveLayer[this._index].GameEarth.y<=this._box.y+data.getBoxRad()+5&&(console.log("Contract earth True"),this._root.dispatchEventWith("GameOver")),1==this._flag&&this._root.dispatchEventWith("timerStart")}},t.prototype.startgame=function(){data.score=0,this._box.x=100,this._box.y=200,this._contentTimer.start(),this._moveTimer.start(),this._moveLayer[this._index].x=0,this._moveLayer[1-this._index].x=data.getStageWidth(),this._root.touchEnabled=!0,this._root.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this._root.addChild(this._score),this._scoreTimer.start(),this._moveLayer[this._index].clearChildren()},t.prototype.gameOver=function(){this._contentTimer.stop(),this._moveTimer.stop(),this._scoreTimer.stop(),this._root.removeChild(this._score),this._root.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this.gameover||(this.gameover=new GameOver,this.gameover.addEventListener("StartGame",this.startgame,this)),this._root.addChild(this.gameover)},t.prototype.socreFunc=function(){this._score.showText()},t}();__reflect(Game.prototype,"Game");var GameOver=function(t){function e(){var e=t.call(this)||this;return e.draw(),e}return __extends(e,t),e.prototype.draw=function(){this.graphics.beginFill(1118481,.5),this.graphics.drawRect(0,0,data.getStageWidth(),data.getStageHeight()),this.graphics.endFill();var t=new egret.Sprite;t.graphics.beginFill(255),t.graphics.drawRect(0,0,200,100),t.graphics.endFill(),t.width=200,t.height=100,t.x=(data.getStageWidth()-200)/2,t.y=(data.getStageHeight()-100)/2,this.addChild(t),t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.startGame,this),this.txt=new egret.TextField,this.txt.width=200,this.txt.height=100,this.txt.x=(data.getStageWidth()-200)/2,this.txt.y=(data.getStageHeight()-100)/2+50,this.txt.textColor=16711680,this.txt.textAlign=egret.HorizontalAlign.CENTER,this.txt.text="Restart",this.addChild(this.txt)},e.prototype.startGame=function(){this.parent.removeChild(this),this.dispatchEventWith("StartGame")},e}(egret.Sprite);__reflect(GameOver.prototype,"GameOver");var moverLayer=function(t){function e(){var e=t.call(this)||this;return e._canflyHeight=125,e._limitHeight=50,e._earthHeight=data.getSpHeight(),e._pipArray=[],e._pipIndex=0,e._randPipX=data.getPiplineX(),e.graphics.beginFill(16777215),e.graphics.drawRect(0,0,data.getStageWidth(),data.getStageHeight()),e.graphics.endFill(),e.draw(),e}return __extends(e,t),e.prototype.draw=function(){this._earth=new earth,this._earth.y=this._earthHeight,this.addChild(this._earth),this.CreatePiplineList()},e.prototype.CreatePiplineList=function(){this.CreatePipline(this._randPipX),this._pipIndex+=2,this.CreatePipline(3*this._randPipX)},e.prototype.CreatePipline=function(t){var e=new Pipline;e.x=t,this.addChild(e);var i=new Pipline;i.x=e.x,this.addChild(i),this._pipArray.push(e),this._pipArray.push(i),this.RandomHeight()},e.prototype.RandomHeight=function(){var t=Math.random()*(this._earthHeight-this._limitHeight-this._canflyHeight);t<=this._limitHeight&&(t=this._limitHeight),this._pipArray[this._pipIndex].caHeight=t,this._pipArray[this._pipIndex+1].y=this._pipArray[this._pipIndex].caHeight+this._canflyHeight,this._pipArray[this._pipIndex+1].caHeight=this._earthHeight-this._pipArray[this._pipIndex].caHeight-this._canflyHeight},Object.defineProperty(e.prototype,"GameEarth",{get:function(){return this._earth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PipArray",{get:function(){return this._pipArray},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PipIndex",{get:function(){return this._pipIndex},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"randPipx",{set:function(t){this._randPipX=t},enumerable:!0,configurable:!0}),e.prototype.clearChildren=function(){for(var t=this._pipArray.length;t;){var e=this._pipArray.pop();this.removeChild(e),--t}this._pipIndex=0},e}(egret.Sprite);__reflect(moverLayer.prototype,"moverLayer");var Pipline=function(t){function e(){var e=t.call(this)||this;return e.draw(),e}return __extends(e,t),e.prototype.draw=function(){this.graphics.lineStyle(2,16773120),this.graphics.beginFill(0),this.graphics.drawRect(0,0,data.getStageWidth()/5,this._caHeight),this.graphics.endFill()},Object.defineProperty(e.prototype,"caHeight",{get:function(){return this._caHeight},set:function(t){this._caHeight=t,this.draw()},enumerable:!0,configurable:!0}),e}(egret.Sprite);__reflect(Pipline.prototype,"Pipline");var ScoreLabel=function(t){function e(){var e=t.call(this)||this;return e.draw(),e}return __extends(e,t),e.prototype.draw=function(){this._txt=new egret.TextField,this._txt.width=data.getStageWidth(),this._txt.y=100,this._txt.textColor=16711680,this._txt.textAlign=egret.HorizontalAlign.CENTER,this.addChild(this._txt)},e.prototype.showText=function(){this._txt.text=data.getscore().toString()},e}(egret.Sprite);__reflect(ScoreLabel.prototype,"ScoreLabel");